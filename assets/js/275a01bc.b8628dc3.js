"use strict";(self.webpackChunkpioreactor=self.webpackChunkpioreactor||[]).push([[935],{10425:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var n=i(85893),s=i(11151);const r={title:"Adding basic time series charts",slug:"/chart-to-ui",hide_table_of_contents:!0},a=void 0,o={id:"User interface/adding-charts",title:"Adding basic time series charts",description:"You can add custom charts to the UI. Below is an example of adding a chart that displays historical and real-time CO2 sensor data.",source:"@site/developer-guide/20-User interface/04-adding-charts.md",sourceDirName:"20-User interface",slug:"/chart-to-ui",permalink:"/developer-guide/chart-to-ui",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"Adding basic time series charts",slug:"/chart-to-ui",hide_table_of_contents:!0},sidebar:"tutorialSidebar",previous:{title:"Examples of using the API",permalink:"/developer-guide/examples-api"},next:{title:"Adding datasets to the Export Data page",permalink:"/developer-guide/dataset-to-ui"}},c={},d=[{value:"Step 1",id:"step-1",level:3},{value:"Step 2",id:"step-2",level:3},{value:"Troubleshooting",id:"troubleshooting",level:3}];function l(e){const t={a:"a",code:"code",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"You can add custom charts to the UI. Below is an example of adding a chart that displays historical and real-time CO2 sensor data."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"custom chart of CO2 reading",src:i(89255).Z+"",width:"1444",height:"754"})}),"\n",(0,n.jsx)(t.h3,{id:"step-1",children:"Step 1"}),"\n",(0,n.jsxs)(t.p,{children:["Create a yaml file with the following fields, and place it in ",(0,n.jsx)(t.code,{children:"/home/pioreactor/.pioreactor/plugins/ui/contrib/charts/"}),". (Plugins can put the yaml file under ",(0,n.jsx)(t.code,{children:"ui/contrib/charts"})," in there project folder - it will be added upon installation.)"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"chart_key"}),": a unique identifier for the chart being added, string."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"data_source"}),": the SQL table to read historical data from. The data source must have a ",(0,n.jsx)(t.code,{children:"timestamp"}),", ",(0,n.jsx)(t.code,{children:"pioreactor_unit"}),", and ",(0,n.jsx)(t.code,{children:"experiment"})," column, along with a numeric column to plot (see below), string."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"data_source_column"}),": the column in ",(0,n.jsx)(t.code,{children:"data_source"})," to read and display, string."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"title"}),": title on the chart, string"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"y_axis_label"}),": the y-axis label, string"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"fixed_decimals"}),": How many decimals to display, integer."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"mqtt_topic"}),": a truncated MQTT topic to read live data from - stripped of the ",(0,n.jsx)(t.code,{children:"pioreactor/<unit>/<experiment>"})," part. Ex: ",(0,n.jsx)(t.code,{children:"co2_readings/ppm"})," if the entire MQTT topic is ",(0,n.jsx)(t.code,{children:"pioreactor/<unit>/<experiment>/co2_readings/ppm"}),", string."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"payload_key"}),": (Optional) If the MQTT topic is json blobs, use the ",(0,n.jsx)(t.code,{children:"payload_key"})," to retrieve the data from the blob, string."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"interpolation"}),": (Optional) the interpolation to use between points, default is ",(0,n.jsx)(t.code,{children:"stepAfter"}),", string."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"y_axis_domain"}),": (Optional) specify a starting y-axis domain. Must be an array, like ",(0,n.jsx)(t.code,{children:"[0.0, 0.5]"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"y_transformation"}),": (Optional) an inline JS function to transform the y data. Default is the identity function, string."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"down_sample"}),": (Optional) A boolean to down-sample the data points from the server or not."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["See examples of yaml files ",(0,n.jsx)(t.a,{href:"https://github.com/Pioreactor/pioreactorui/tree/master/contrib/charts",children:"here"})," and ",(0,n.jsx)(t.a,{href:"https://forum.pioreactor.com/t/creating-stirring-rpm-and-pwm-duty-cycle-charts-on-the-ui/339",children:"here"}),"."]}),"\n",(0,n.jsx)(t.h3,{id:"step-2",children:"Step 2"}),"\n",(0,n.jsxs)(t.p,{children:["In your config.ini, add your chart key under ",(0,n.jsx)(t.code,{children:"[ui.overview.charts]"})," and assign it 1. Example:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"[ui.overview.charts]\n# show/hide charts on the PioreactorUI dashboard\n# 1 is show, 0 is hide\n...\nco2_readings=1\n...\n"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(71539).Z+"",width:"1168",height:"942"})}),"\n",(0,n.jsx)(t.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"If the UI stops displaying data, you may have introduced a yaml file that is not being read correctly. Check out the Pioreactor UI logs by sshing into the leader, and running:"}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"tail /var/log/pioreactor.log\n"})}),"\n",(0,n.jsx)(t.p,{children:"The last few lines should tell you about if a field is missing, a wrong type, etc."}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"There is a 30 second cache, so it may take up to 30 second to see new changes in the UI."}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},71539:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/adding_chart_to_config-0a40556bd41c8cd70abdf292e4f2ef52.png"},89255:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/custom_chart-483a2cbf50e927eda0208ebab3521cae.png"},11151:(e,t,i)=>{i.d(t,{Z:()=>o,a:()=>a});var n=i(67294);const s={},r=n.createContext(s);function a(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);