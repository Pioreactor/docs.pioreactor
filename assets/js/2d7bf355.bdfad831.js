"use strict";(self.webpackChunkpioreactor=self.webpackChunkpioreactor||[]).push([[7118],{3905:(e,t,r)=>{r.d(t,{Zo:()=>d,kt:()=>h});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var p=n.createContext({}),s=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},d=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=s(r),h=o,m=u["".concat(p,".").concat(h)]||u[h]||c[h]||a;return r?n.createElement(m,i(i({ref:t},d),{},{components:r})):n.createElement(m,i({ref:t},d))}));function h(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var s=2;s<a;s++)i[s]=r[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},51076:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var n=r(87462),o=(r(67294),r(3905));const a={title:"Overview",slug:"/web-ui-introduction"},i=void 0,l={unversionedId:"User interface/introduction",id:"User interface/introduction",title:"Overview",description:"The web UI is hosted on the leader Pioreactor. Here are the details:",source:"@site/developer-guide/20-User interface/01-introduction.md",sourceDirName:"20-User interface",slug:"/web-ui-introduction",permalink:"/developer-guide/web-ui-introduction",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Overview",slug:"/web-ui-introduction"},sidebar:"tutorialSidebar",previous:{title:"Adding behaviour to the HAT's button",permalink:"/developer-guide/hat-button"},next:{title:"API",permalink:"/developer-guide/web-ui-api"}},p={},s=[{value:"Web server",id:"web-server",level:3},{value:"Backend",id:"backend",level:3},{value:"Frontend",id:"frontend",level:3},{value:"DNS name resolution to <code>pioreactor.local</code>",id:"dns-name-resolution-to-pioreactorlocal",level:3},{value:"Updating and restarting the web UI",id:"updating-and-restarting-the-web-ui",level:3},{value:"Logs",id:"logs",level:3}],d={toc:s};function c(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The web UI is hosted on the leader Pioreactor. Here are the details:"),(0,o.kt)("h3",{id:"web-server"},"Web server"),(0,o.kt)("p",null,"The web server we use is lighttp, and hosted from ",(0,o.kt)("inlineCode",{parentName:"p"},"/var/www/pioreactorui"),". This folder is actually a git repo, and pulls from ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/pioreactor/pioreactorui"},"pioreactorui")," GH repo. Systemd controls starting and restarting lighttp."),(0,o.kt)("p",null,"The lighttp conf file is located in ",(0,o.kt)("inlineCode",{parentName:"p"},"/etc/lighttpd/conf-enabled/50-pioreactorui.conf"),". Error logs (though not helpful) are in ",(0,o.kt)("inlineCode",{parentName:"p"},"/var/log/lighttpd/error.log"),"."),(0,o.kt)("h3",{id:"backend"},"Backend"),(0,o.kt)("p",null,"The backend app is a Flask app, with entry point in ",(0,o.kt)("inlineCode",{parentName:"p"},"/var/www/pioreactorui/main.fcgi"),". The app uses Huey as background workers to perform ",(0,o.kt)("inlineCode",{parentName:"p"},"pio")," tasks, save to disk, etc. Huey is controlled by systemd ",(0,o.kt)("inlineCode",{parentName:"p"},"huey.service"),". The API is ",(0,o.kt)("a",{parentName:"p",href:"/developer-guide/web-ui-api"},"available here")),(0,o.kt)("h3",{id:"frontend"},"Frontend"),(0,o.kt)("p",null,"The frontend is a React app, built with Material UI components. The source code is at ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Pioreactor/pioreactorui_frontend"},"pioreactorui_frontend"),'. A lot of the "data" for the frontend comes from YAML files on the RPi\'s filesystem. For example, all the charts, activities, and automations are defined in their own YAML file in a ',(0,o.kt)("inlineCode",{parentName:"p"},"contrib")," folder on the filesystem. This way, it's easy to add new data to the frontend without having to write new JS."),(0,o.kt)("h3",{id:"dns-name-resolution-to-pioreactorlocal"},"DNS name resolution to ",(0,o.kt)("inlineCode",{parentName:"h3"},"pioreactor.local")),(0,o.kt)("p",null,"To allow for ",(0,o.kt)("inlineCode",{parentName:"p"},"pioreactor.local")," to be an alias for ",(0,o.kt)("inlineCode",{parentName:"p"},"<leader hostname>.local"),", we use mdns provided by ",(0,o.kt)("inlineCode",{parentName:"p"},"avahi"),". There is a systemd service, ",(0,o.kt)("inlineCode",{parentName:"p"},"avahi_alias.service"),", that will point ",(0,o.kt)("inlineCode",{parentName:"p"},"pioreactor.local")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"<leader hostname>.local"),"."),(0,o.kt)("h3",{id:"updating-and-restarting-the-web-ui"},"Updating and restarting the web UI"),(0,o.kt)("p",null,"To update on the UI on Pioreactor leader, use ",(0,o.kt)("inlineCode",{parentName:"p"},"pio update ui"),". This also restarts the server."),(0,o.kt)("p",null,"To restart:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo systemctl restart lighttp && sudo systemctl restart huey\n")),(0,o.kt)("h3",{id:"logs"},"Logs"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Start up logs from systemd are in ",(0,o.kt)("inlineCode",{parentName:"li"},"sudo systemctl status lighttpd.service"),"."),(0,o.kt)("li",{parentName:"ul"},"Logs for the backend and background workers are located in ",(0,o.kt)("inlineCode",{parentName:"li"},"/var/log/pioreactorui.log"),".")))}c.isMDXComponent=!0}}]);