"use strict";(self.webpackChunkpioreactor=self.webpackChunkpioreactor||[]).push([[8596],{95980:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>a});var i=o(85893),t=o(11151);const r={title:"Networking tools",slug:"/networking"},s=void 0,c={id:"Advanced/networking/networking",title:"Networking tools",description:"Previously, Raspberry Pis used a file called wpasupplicant.conf to handle wifi network connections. **This is not longer the case**. Modern Raspberry Pi software, including the Pioreactor, doesn't use wpasupplicant.conf at all. Instead, the tool nmcli replaces it. Don't follow tutorials that use wpa_supplicant.conf.",source:"@site/user-guide/30-Advanced/02-networking/10-networking.md",sourceDirName:"30-Advanced/02-networking",slug:"/networking",permalink:"/user-guide/networking",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{title:"Networking tools",slug:"/networking"},sidebar:"tutorialSidebar",previous:{title:"Local access points",permalink:"/user-guide/local-access-point"},next:{title:"More on peristaltic pumps",permalink:"/user-guide/addition-hardware-pumps"}},l={},a=[{value:"General networking tools",id:"general-networking-tools",level:2},{value:"Connecting to a wifi network using <code>nmcli</code>",id:"connecting-to-a-wifi-network-using-nmcli",level:3},{value:"Connecting to multiple networks simultaneously",id:"connecting-to-multiple-networks-simultaneously",level:3},{value:"Starting the Pioreactor local access point using <code>nmcli</code>",id:"starting-the-pioreactor-local-access-point-using-nmcli",level:3},{value:"Changing <code>leader_address</code> and MQTT <code>broker</code> in your config.ini",id:"changing-leader_address-and-mqtt-broker-in-your-configini",level:4},{value:"Changing web UI port from <code>80</code> to something else",id:"changing-web-ui-port-from-80-to-something-else",level:3},{value:"Connecting to eduroam",id:"connecting-to-eduroam",level:2},{value:"Common questions",id:"common-questions",level:2},{value:"My Pioreactor activities start very slowly from the UI",id:"my-pioreactor-activities-start-very-slowly-from-the-ui",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Previously, Raspberry Pis used a file called ",(0,i.jsx)(n.code,{children:"wpa_supplicant.conf"})," to handle wifi network connections. ",(0,i.jsx)(n.strong,{children:"This is not longer the case"}),". Modern Raspberry Pi software, including the Pioreactor, doesn't use ",(0,i.jsx)(n.code,{children:"wpa_supplicant.conf"})," at all. Instead, the tool ",(0,i.jsx)(n.code,{children:"nmcli"})," replaces it. Don't follow tutorials that use ",(0,i.jsx)(n.code,{children:"wpa_supplicant.conf"}),"."]})}),"\n",(0,i.jsx)(n.h2,{id:"general-networking-tools",children:"General networking tools"}),"\n",(0,i.jsxs)(n.p,{children:['The main "entry point" for networking on the Pioreactor (and Raspberry Pi\'s in general) is the tool ',(0,i.jsx)(n.code,{children:"nmcli"}),". This controls discovering networks, connecting to them, and editing connections. For example, running ",(0,i.jsx)(n.code,{children:"nmcli con"})," will diplay a list of possible networking connections, and connected ones in green."]}),"\n",(0,i.jsxs)(n.h3,{id:"connecting-to-a-wifi-network-using-nmcli",children:["Connecting to a wifi network using ",(0,i.jsx)(n.code,{children:"nmcli"})]}),"\n",(0,i.jsx)(n.p,{children:"You can first discover all the visible networks with:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo nmcli d wifi list\n"})}),"\n",(0,i.jsx)(n.p,{children:"If you see your network on the list, then run:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo nmcli device wifi connect <ssid name> password <ssid password> ifname wlan0\n"})}),"\n",(0,i.jsxs)(n.p,{children:['(If you get a "Can\'t find" error, try running the above ',(0,i.jsx)(n.code,{children:"list"})," command again.)"]}),"\n",(0,i.jsx)(n.h3,{id:"connecting-to-multiple-networks-simultaneously",children:"Connecting to multiple networks simultaneously"}),"\n",(0,i.jsx)(n.p,{children:"First, some terminology and understanding for us: a computer, like a Pi, has networking interfaces. For example, the onboard wifi on RPi\u2019s is one such interface. The larger, model Bs, have an ethernet connector, which is another interface. Each interface can connect to 0 or 1 networks."}),"\n",(0,i.jsxs)(n.p,{children:["In order to connect to multiple networks, you need a Raspberry Pi with multiple interfaces. You can add interfaces with devices like a ",(0,i.jsx)(n.a,{href:"https://forum.pioreactor.com/t/connecting-more-workers-to-cluster/330/3",children:"USB wifi device"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"To see what your current interfaces are doing, use:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"nmcli device\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The right hand side shows your connected interfaces. For example, if have a ethernet connection to a router, you'll see an ",(0,i.jsx)(n.code,{children:"eth0"})," connection active. If you have an additional wifi hardware device attached to your Pi, you'll see ",(0,i.jsx)(n.code,{children:"wlan1"}),"."]}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsxs)(n.p,{children:["To connect to another wifi network using an external ",(0,i.jsx)(n.code,{children:"wlan1"})," interface, use:"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo nmcli device wifi connect <ssid name> password <ssid password> ifname wlan1\n"})})]}),"\n",(0,i.jsxs)(n.p,{children:["If your leader is connected to multiple networks ",(0,i.jsx)(n.code,{children:"A"})," and ",(0,i.jsx)(n.code,{children:"B"}),", and you access the UI over network ",(0,i.jsx)(n.code,{children:"A"}),", but your workers access over network ",(0,i.jsx)(n.code,{children:"B"}),', the leader is in the position called a "gateway". You\'ll need to make some configuration changes to your cluster. Since the leader is attached to networks ',(0,i.jsx)(n.code,{children:"A"})," and ",(0,i.jsx)(n.code,{children:"B"}),", it has two IPs (use ",(0,i.jsx)(n.code,{children:"hostname -I"})," to see all the ips), let's call them ",(0,i.jsx)(n.code,{children:"ipA"})," and ",(0,i.jsx)(n.code,{children:"ipB"})," respectively."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Access the configuration in the UI."}),"\n",(0,i.jsxs)(n.li,{children:["In the ",(0,i.jsx)(n.em,{children:"shared"})," config.ini, edit the ",(0,i.jsx)(n.code,{children:"[mqtt]"})," ",(0,i.jsx)(n.code,{children:"broker"})," field to be equal to ",(0,i.jsx)(n.code,{children:"ipA"}),". Also edit the ",(0,i.jsx)(n.code,{children:"leader_address"})," to be ",(0,i.jsx)(n.code,{children:"ipB"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["In each of the workers (including the leader's config.ini, if it's a worker), add the following:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[mqtt]\nbroker=ipB\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"You may need to restart your cluster for these to take full effect."}),"\n",(0,i.jsxs)(n.h3,{id:"starting-the-pioreactor-local-access-point-using-nmcli",children:["Starting the ",(0,i.jsx)(n.a,{href:"/user-guide/local-access-point",children:"Pioreactor local access"})," point using ",(0,i.jsx)(n.code,{children:"nmcli"})]}),"\n",(0,i.jsx)(n.p,{children:"Note that you can only have 1 network connection for each network interface. So if you have only 1 wifi device (by default, RPi's only have 1 wifi device on them -> only 1 wifi interface), the following will replace any existing wifi connection."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo nmcli con up PioreactorAP\n"})}),"\n",(0,i.jsxs)(n.h4,{id:"changing-leader_address-and-mqtt-broker-in-your-configini",children:["Changing ",(0,i.jsx)(n.code,{children:"leader_address"})," and MQTT ",(0,i.jsx)(n.code,{children:"broker"})," in your config.ini"]}),"\n",(0,i.jsxs)(n.p,{children:["You may need to change the ",(0,i.jsx)(n.code,{children:"leader_address"})," in your config.ini: this is the address where workers will communicate with your leader."]}),"\n",(0,i.jsxs)(n.p,{children:["Likewise, you may need to change the mqtt ",(0,i.jsx)(n.code,{children:"broker"})," in your config.ini for the same reason. It may be required to change it in the unit specific config.inis."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",metastring:'title="config_worker01.ini"',children:"[mqtt]\nbroker=leader.local\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"changing-web-ui-port-from-80-to-something-else",children:["Changing web UI port from ",(0,i.jsx)(n.code,{children:"80"})," to something else"]}),"\n",(0,i.jsxs)(n.p,{children:["To change the web UI port from the default of ",(0,i.jsx)(n.code,{children:"80"}),", following these instructions:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"SSH into your leader Pioreactor."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"We'll edit the lighttpd configuration first:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo nano /etc/lighttpd/lighttpd.conf\n"})}),"\n",(0,i.jsxs)(n.p,{children:["and find the line starting with ",(0,i.jsx)(n.code,{children:"server.port"}),". Change this to something else (preferably not a value below 1024). Save and exit."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Restart lighttpd with:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo systemctl restart lighttpd.service\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You should be able to access the web UI only on http://",(0,i.jsx)(n.code,{children:"leader name"}),":",(0,i.jsx)(n.code,{children:"new port"}),", for example: ",(0,i.jsx)(n.a,{href:"http://leader.local:8080",children:"http://leader.local:8080"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In your configuration, under the ",(0,i.jsx)(n.code,{children:"[ui]"})," section, change the ",(0,i.jsx)(n.code,{children:"port"})," option from ",(0,i.jsx)(n.code,{children:"80"})," to your new port value. Save. You may need to restart your cluster for this new port to propagate to all machines correctly."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"connecting-to-eduroam",children:"Connecting to eduroam"}),"\n",(0,i.jsxs)(n.p,{children:["This is a work-in-progress, but here's ",(0,i.jsx)(n.a,{href:"https://forum.pioreactor.com/t/connecting-more-workers-to-cluster/330/3#connecting-to-eduroam-2",children:"one example"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"common-questions",children:"Common questions"}),"\n",(0,i.jsx)(n.h3,{id:"my-pioreactor-activities-start-very-slowly-from-the-ui",children:"My Pioreactor activities start very slowly from the UI"}),"\n",(0,i.jsxs)(n.p,{children:['It is possible that your mDNS is being blocked or restricted. If possible, log into your router and enable settings that allow "multicast", or "mDNS", or "IGMP proxing". If you are using a the builtin ',(0,i.jsx)(n.a,{href:"/user-guide/local-access-point",children:"local access point"}),", this solution is not the correct one."]}),"\n",(0,i.jsx)(n.p,{children:"Also, if you are able to provide a permanent IPv4 address to your leader, you can get a significant performance boost by setting the configuration some config parameters to the IPv4 address."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[cluster.topology]\n# below is an example, your IPv4 may differ:\nleader_address=192.168.0.3\n\n[mqtt]\nbroker_address=192.168.0.3\n\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},11151:(e,n,o)=>{o.d(n,{Z:()=>c,a:()=>s});var i=o(67294);const t={},r=i.createContext(t);function s(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);